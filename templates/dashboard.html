<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computer Prices Analysis Dashboard</title>

  <!-- Bootstrap CSS -->
  <link
   href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
   rel="stylesheet"
  />

  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <!-- Custom CSS -->
  <style>
   body {
    background-color: #f8f9fa;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
   }

   .navbar {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
   }

   .chart-container {
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 30px;
    padding: 20px;
    transition: transform 0.2s;
   }

   .chart-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
   }

   .stats-card {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
   }

   .stats-card h3 {
    font-size: 2.5rem;
    font-weight: bold;
    margin-bottom: 5px;
   }

   .stats-card p {
    margin: 0;
    opacity: 0.9;
   }

   .loading {
    text-align: center;
    padding: 40px;
    color: #6c757d;
   }

   .section-title {
    color: #495057;
    border-bottom: 3px solid #667eea;
    padding-bottom: 10px;
    margin-bottom: 30px;
    font-weight: 600;
   }

   .dashboard-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px 0;
    margin-bottom: 40px;
   }

   .btn-refresh {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    border-radius: 25px;
    padding: 10px 25px;
    color: white;
    transition: all 0.3s;
   }

   .btn-refresh:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    color: white;
   }
  </style>
 </head>
 <body>
  <!-- Navigation -->
  <nav class="navbar navbar-dark">
   <div class="container">
    <span class="navbar-brand mb-0 h1">
     <i class="fas fa-chart-line me-2"></i>
     Computer Prices Analysis Dashboard
    </span>
    <button class="btn btn-refresh" onclick="refreshDashboard()">
     <i class="fas fa-sync-alt me-1"></i>
     Refresh Data
    </button>
   </div>
  </nav>

  <!-- Dashboard Header -->
  <div class="dashboard-header">
   <div class="container text-center">
    <h1 class="display-4 mb-3">Computer Market Analysis</h1>
    <p class="lead">
     Comprehensive analysis of computer prices and specifications across
     different brands and categories
    </p>
   </div>
  </div>

  <div class="container">
   <!-- Summary Statistics -->
   <div class="row mb-5">
    <div class="col-12">
     <h2 class="section-title">üìä Key Statistics</h2>
    </div>
    <div class="col-md-3">
     <div class="stats-card">
      <h3 id="total-devices">-</h3>
      <p>Total Devices</p>
     </div>
    </div>
    <div class="col-md-3">
     <div class="stats-card">
      <h3 id="avg-price">-</h3>
      <p>Average Price</p>
     </div>
    </div>
    <div class="col-md-3">
     <div class="stats-card">
      <h3 id="price-range">-</h3>
      <p>Price Range</p>
     </div>
    </div>
    <div class="col-md-3">
     <div class="stats-card">
      <h3 id="correlation">-</h3>
      <p>Price-Performance Correlation</p>
     </div>
    </div>
   </div>

   <!-- Main Visualizations -->
   <div class="row">
    <div class="col-12">
     <h2 class="section-title">üìà Price and Performance Analysis</h2>
    </div>

    <!-- Scatter Plot -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="scatter-plot" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Price vs Performance chart...</p>
      </div>
     </div>
    </div>

    <!-- Bar Chart -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="bar-chart" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Top Brands chart...</p>
      </div>
     </div>
    </div>

    <!-- Box Plot -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="box-plot" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading OS Price Distribution...</p>
      </div>
     </div>
    </div>

    <!-- Histogram -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="histogram" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Price Distribution...</p>
      </div>
     </div>
    </div>
   </div>

   <!-- Secondary Visualizations -->
   <div class="row">
    <div class="col-12">
     <h2 class="section-title">üîç Detailed Analysis</h2>
    </div>

    <!-- Pie Chart -->
    <div class="col-lg-4">
     <div class="chart-container">
      <div id="pie-chart" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Device Types...</p>
      </div>
     </div>
    </div>

    <!-- Violin Plot -->
    <div class="col-lg-8">
     <div class="chart-container">
      <div id="violin-plot" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading CPU Brand Analysis...</p>
      </div>
     </div>
    </div>

    <!-- Line Chart -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="line-chart" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Price Trends...</p>
      </div>
     </div>
    </div>

    <!-- Stacked Bar -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="stacked-bar" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading GPU Analysis...</p>
      </div>
     </div>
    </div>
   </div>

   <!-- Advanced Visualizations -->
   <div class="row">
    <div class="col-12">
     <h2 class="section-title">üéØ Advanced Analysis</h2>
    </div>

    <!-- Heatmap -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="heatmap" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Correlation Matrix...</p>
      </div>
     </div>
    </div>

    <!-- Multi-subplot Dashboard -->
    <div class="col-lg-6">
     <div class="chart-container">
      <div id="subplot-dashboard" class="loading">
       <div class="spinner-border" role="status"></div>
       <p>Loading Multi-metric Dashboard...</p>
      </div>
     </div>
    </div>
   </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-light text-center py-4 mt-5">
   <div class="container">
    <p>&copy; 2025 Computer Prices Analysis Dashboard. Data Science Project.</p>
   </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Font Awesome -->
  <script
   src="https://kit.fontawesome.com/your-fontawesome-kit.js"
   crossorigin="anonymous"
  ></script>

  <!-- Custom JavaScript -->
  <script>
   // Global variables to store chart data
   let chartsData = {};
   let statsData = {};

   // Load dashboard data
   async function loadDashboard() {
    try {
     // Load statistics
     const statsResponse = await fetch("/api/stats");
     statsData = await statsResponse.json();
     updateStats();

     // Load charts
     const chartsResponse = await fetch("/api/charts");
     chartsData = await chartsResponse.json();
     renderCharts();
    } catch (error) {
     console.error("Error loading dashboard:", error);
     showError("Failed to load dashboard data. Please refresh the page.");
    }
   }

   // Update statistics cards
   function updateStats() {
    document.getElementById("total-devices").textContent =
     statsData.total_devices.toLocaleString();
    document.getElementById("avg-price").textContent =
     "$" + statsData.avg_price.toLocaleString();
    document.getElementById("price-range").textContent =
     "$" + statsData.min_price + " - $" + statsData.max_price.toLocaleString();
    document.getElementById("correlation").textContent =
     statsData.price_performance_corr;
   }

   // Render all charts
   function renderCharts() {
    // Scatter plot
    Plotly.newPlot(
     "scatter-plot",
     JSON.parse(chartsData.scatter_price_performance).data,
     JSON.parse(chartsData.scatter_price_performance).layout
    );

    // Bar chart
    Plotly.newPlot(
     "bar-chart",
     JSON.parse(chartsData.bar_top_brands).data,
     JSON.parse(chartsData.bar_top_brands).layout
    );

    // Box plot
    Plotly.newPlot(
     "box-plot",
     JSON.parse(chartsData.box_price_os).data,
     JSON.parse(chartsData.box_price_os).layout
    );

    // Histogram
    Plotly.newPlot(
     "histogram",
     JSON.parse(chartsData.hist_price).data,
     JSON.parse(chartsData.hist_price).layout
    );

    // Pie chart
    Plotly.newPlot(
     "pie-chart",
     JSON.parse(chartsData.pie_device_type).data,
     JSON.parse(chartsData.pie_device_type).layout
    );

    // Violin plot
    Plotly.newPlot(
     "violin-plot",
     JSON.parse(chartsData.violin_cpu_brand).data,
     JSON.parse(chartsData.violin_cpu_brand).layout
    );

    // Line chart
    Plotly.newPlot(
     "line-chart",
     JSON.parse(chartsData.line_price_trend).data,
     JSON.parse(chartsData.line_price_trend).layout
    );

    // Stacked bar
    Plotly.newPlot(
     "stacked-bar",
     JSON.parse(chartsData.stacked_gpu_device).data,
     JSON.parse(chartsData.stacked_gpu_device).layout
    );

    // Heatmap
    Plotly.newPlot(
     "heatmap",
     JSON.parse(chartsData.heatmap_correlation).data,
     JSON.parse(chartsData.heatmap_correlation).layout
    );

    // Multi-subplot dashboard
    Plotly.newPlot(
     "subplot-dashboard",
     JSON.parse(chartsData.subplot_dashboard).data,
     JSON.parse(chartsData.subplot_dashboard).layout
    );
   }

   // Refresh dashboard
   function refreshDashboard() {
    // Show loading state
    const chartContainers = document.querySelectorAll(".chart-container > div");
    chartContainers.forEach((container) => {
     container.innerHTML = `
                    <div class="loading">
                        <div class="spinner-border" role="status"></div>
                        <p>Refreshing...</p>
                    </div>
                `;
    });

    // Reload data
    loadDashboard();
   }

   // Show error message
   function showError(message) {
    const alertDiv = document.createElement("div");
    alertDiv.className = "alert alert-danger alert-dismissible fade show";
    alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
    document
     .querySelector(".container")
     .insertBefore(alertDiv, document.querySelector(".container").firstChild);
   }

   // Initialize dashboard when page loads
   document.addEventListener("DOMContentLoaded", function () {
    loadDashboard();
   });

   // Make charts responsive
   window.addEventListener("resize", function () {
    if (Object.keys(chartsData).length > 0) {
     Object.keys(chartsData).forEach((chartKey) => {
      const elementId = chartKey.replace(/_/g, "-");
      Plotly.Plots.resize(elementId);
     });
    }
   });
  </script>
 </body>
</html>
