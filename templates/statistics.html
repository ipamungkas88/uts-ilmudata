<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computer Data - Descriptive Statistics</title>

  <!-- Bootstrap CSS -->
  <link
   href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
   rel="stylesheet"
  />

  <!-- Font Awesome -->
  <link
   rel="stylesheet"
   href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
  />

  <!-- Custom CSS -->
  <style>
   body {
    background-color: #f8f9fa;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
   }

   .navbar {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
   }

   .stats-card {
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
    padding: 20px;
    transition: transform 0.2s;
   }

   .stats-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
   }

   .section-title {
    color: #495057;
    border-bottom: 3px solid #667eea;
    padding-bottom: 10px;
    margin-bottom: 30px;
    font-weight: 600;
   }

   .dashboard-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px 0;
    margin-bottom: 40px;
   }

   .stat-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
   }

   .stat-table th {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 15px;
   }

   .stat-table td {
    padding: 12px 15px;
    border-bottom: 1px solid #e9ecef;
   }

   .loading {
    text-align: center;
    padding: 40px;
    color: #6c757d;
   }

   .nav-pills .nav-link.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
   }

   .summary-card {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    text-align: center;
   }

   .summary-card h3 {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 5px;
   }
  </style>
 </head>
 <body>
  <!-- Navigation -->
  <nav class="navbar navbar-dark navbar-expand-lg">
   <div class="container">
    <a class="navbar-brand" href="/">
     <i class="fas fa-chart-bar me-2"></i>
     Computer Data Analysis
    </a>
    <button
     class="navbar-toggler"
     type="button"
     data-bs-toggle="collapse"
     data-bs-target="#navbarNav"
    >
     <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
     <ul class="navbar-nav ms-auto">
      <li class="nav-item">
       <a class="nav-link active" href="/statistics">
        <i class="fas fa-table me-1"></i>
        Statistics
       </a>
      </li>
      <li class="nav-item">
       <a class="nav-link" href="/charts">
        <i class="fas fa-chart-line me-1"></i>
        Charts
       </a>
      </li>
     </ul>
    </div>
   </div>
  </nav>

  <!-- Dashboard Header -->
  <div class="dashboard-header">
   <div class="container text-center">
    <h1 class="display-4 mb-3">
     <i class="fas fa-table me-3"></i>
     Statistik deskriptif
    </h1>
   </div>
  </div>

  <div class="container">
   <!-- Summary Statistics -->
   <div class="row mb-5">
    <div class="col-12">
     <h2 class="section-title">ðŸ“Š Data Summary</h2>
    </div>
    <div class="col-md-2">
     <div class="summary-card">
      <h3 id="total-devices">-</h3>
      <p>Total Devices</p>
     </div>
    </div>
    <div class="col-md-2">
     <div class="summary-card">
      <h3 id="total-brands">-</h3>
      <p>Brands</p>
     </div>
    </div>
    <div class="col-md-2">
     <div class="summary-card">
      <h3 id="total-models">-</h3>
      <p>Models</p>
     </div>
    </div>
    <div class="col-md-3">
     <div class="summary-card">
      <h3 id="avg-price">-</h3>
      <p>Average Price</p>
     </div>
    </div>
    <div class="col-md-3">
     <div class="summary-card">
      <h3 id="price-range">-</h3>
      <p>Price Range</p>
     </div>
    </div>
   </div>

   <!-- Statistics Content -->
   <div class="row">
    <div class="col-12">
     <h2 class="section-title">ðŸ“ˆ Detailed Statistics</h2>
    </div>

    <!-- Navigation Pills -->
    <div class="col-12 mb-4">
     <ul class="nav nav-pills justify-content-center" id="statisticsTabs">
      <li class="nav-item">
       <button
        class="nav-link active"
        data-bs-toggle="pill"
        data-bs-target="#categorical"
        type="button"
       >
        <i class="fas fa-tags me-1"></i>
        Categorical Data
       </button>
      </li>
      <li class="nav-item">
       <button
        class="nav-link"
        data-bs-toggle="pill"
        data-bs-target="#numerical"
        type="button"
       >
        <i class="fas fa-calculator me-1"></i>
        Numerical Data
       </button>
      </li>
     </ul>
    </div>

    <!-- Tab Content -->
    <div class="col-12">
     <div class="tab-content" id="statisticsTabContent">
      <!-- Categorical Statistics -->
      <div class="tab-pane fade show active" id="categorical">
       <div id="categorical-stats" class="loading">
        <div class="spinner-border" role="status"></div>
        <p>Loading categorical statistics...</p>
       </div>
      </div>

      <!-- Numerical Statistics -->
      <div class="tab-pane fade" id="numerical">
       <div id="numerical-stats" class="loading">
        <div class="spinner-border" role="status"></div>
        <p>Loading numerical statistics...</p>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-light text-center py-4 mt-5">
   <div class="container">
    <p>&copy; 2025 Computer Data Analysis. Data Science Project.</p>
   </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Custom JavaScript -->
  <script>
   // Global variables
   let statisticsData = {};
   let summaryData = {};

   // Load data
   async function loadStatistics() {
    try {
     // Load summary data
     const summaryResponse = await fetch("/api/summary");
     summaryData = await summaryResponse.json();
     updateSummary();

     // Load detailed statistics
     const statsResponse = await fetch("/api/statistics");
     statisticsData = await statsResponse.json();
     renderStatistics();
    } catch (error) {
     console.error("Error loading statistics:", error);
     showError("Failed to load statistics data. Please refresh the page.");
    }
   }

   // Update summary cards
   function updateSummary() {
    document.getElementById("total-devices").textContent =
     summaryData.total_devices?.toLocaleString() || "-";
    document.getElementById("total-brands").textContent =
     summaryData.total_brands || "-";
    document.getElementById("total-models").textContent =
     summaryData.total_models || "-";
    document.getElementById("avg-price").textContent = summaryData.avg_price
     ? "$" + summaryData.avg_price.toLocaleString()
     : "-";

    const priceRange =
     summaryData.min_price && summaryData.max_price
      ? "$" +
        summaryData.min_price +
        " - $" +
        summaryData.max_price.toLocaleString()
      : "-";
    document.getElementById("price-range").textContent = priceRange;
   }

   // Render statistics tables
   function renderStatistics() {
    renderCategoricalStats();
    renderNumericalStats();
   }

   // Render categorical statistics
   function renderCategoricalStats() {
    const container = document.getElementById("categorical-stats");
    let html = "";

    Object.keys(statisticsData).forEach((column) => {
     const stat = statisticsData[column];
     if (stat.type === "categorical") {
      html += `
                        <div class="stats-card">
                            <h4 class="mb-3">
                                <i class="fas fa-tag me-2"></i>
                                ${column.replace(/_/g, " ").toUpperCase()}
                            </h4>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Basic Statistics</h6>
                                    <table class="table stat-table">
                                        <tr><th>Count</th><td>${
                                         stat.describe.count
                                        }</td></tr>
                                        <tr><th>Unique Values</th><td>${
                                         stat.describe.unique
                                        }</td></tr>
                                        <tr><th>Most Frequent</th><td>${
                                         stat.describe.top
                                        }</td></tr>
                                        <tr><th>Frequency</th><td>${
                                         stat.describe.freq
                                        }</td></tr>
                                    </table>
                                </div>
                                <div class="col-md-6">
                                    <h6>Top Values</h6>
                                    <table class="table stat-table">
                                        <thead>
                                            <tr><th>Value</th><th>Count</th></tr>
                                        </thead>
                                        <tbody>
                    `;

      Object.entries(stat.value_counts)
       .slice(0, 5)
       .forEach(([value, count]) => {
        html += `<tr><td>${value}</td><td>${count}</td></tr>`;
       });

      html += `
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    `;
     }
    });

    container.innerHTML = html;
   }

   // Render numerical statistics
   function renderNumericalStats() {
    const container = document.getElementById("numerical-stats");
    let html = "";

    Object.keys(statisticsData).forEach((column) => {
     const stat = statisticsData[column];
     if (stat.type === "numerical") {
      html += `
                        <div class="stats-card">
                            <h4 class="mb-3">
                                <i class="fas fa-calculator me-2"></i>
                                ${column.replace(/_/g, " ").toUpperCase()}
                            </h4>
                            <div class="table-responsive">
                                <table class="table stat-table">
                                    <thead>
                                        <tr>
                                            <th>Statistic</th>
                                            <th>Value</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>Count</td><td>${
                                         stat.describe.count
                                        }</td></tr>
                                        <tr><td>Mean</td><td>${
                                         stat.describe.mean?.toFixed(2) || "N/A"
                                        }</td></tr>
                                        <tr><td>Standard Deviation</td><td>${
                                         stat.describe.std?.toFixed(2) || "N/A"
                                        }</td></tr>
                                        <tr><td>Minimum</td><td>${
                                         stat.describe.min?.toFixed(2) || "N/A"
                                        }</td></tr>
                                        <tr><td>25th Percentile (Q1)</td><td>${
                                         stat.quartiles?.Q1?.toFixed(2) || "N/A"
                                        }</td></tr>
                                        <tr><td>Median (Q2)</td><td>${
                                         stat.describe["50%"]?.toFixed(2) ||
                                         "N/A"
                                        }</td></tr>
                                        <tr><td>75th Percentile (Q3)</td><td>${
                                         stat.quartiles?.Q3?.toFixed(2) || "N/A"
                                        }</td></tr>
                                        <tr><td>Maximum</td><td>${
                                         stat.describe.max?.toFixed(2) || "N/A"
                                        }</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
     }
    });

    container.innerHTML = html;
   }

   // Show error message
   function showError(message) {
    const alertDiv = document.createElement("div");
    alertDiv.className = "alert alert-danger alert-dismissible fade show";
    alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
    document
     .querySelector(".container")
     .insertBefore(alertDiv, document.querySelector(".container").firstChild);
   }

   // Initialize page
   document.addEventListener("DOMContentLoaded", function () {
    loadStatistics();
   });
  </script>
 </body>
</html>
